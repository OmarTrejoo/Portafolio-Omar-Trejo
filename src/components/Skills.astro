---
import type { SkillCategory } from "../types";
import BackgroundEffects from "./ui/BackgroundEffects.astro";
import SectionBackground from "./ui/SectionBackground.astro";
import SectionTitle from "./ui/SectionTitle.astro";
import Card from "./ui/Card.astro";
import Badge from "./ui/Badge.astro";

interface Props {
  technicalSkills: SkillCategory[];
  softSkills: string[];
  lang: 'es' | 'en';
}

const { technicalSkills, softSkills, lang } = Astro.props;

const labels = {
  title: lang === 'es' ? 'Mis Habilidades' : 'My Skills'
};


const skillIcons: Record<string, string> = {

  'JavaScript': '/referencias img/tecnologías/js.svg',
  'PHP': '/referencias img/tecnologías/php.png',
  'Dart': '/referencias img/tecnologías/dart-192.svg',
  'Python': '/referencias img/tecnologías/python.svg',
  'SQL': '/referencias img/tecnologías/mysql.svg',
  'HTML': '/referencias img/tecnologías/html.svg',
  'CSS': '/referencias img/tecnologías/css.png',
  

  'React': '/referencias img/tecnologías/react.svg',
  'Flutter': '/referencias img/tecnologías/flutter.png',
  'Node.js': '/referencias img/tecnologías/node.svg',
  'Laravel': '/referencias img/tecnologías/Laravel.svg.png',
  

  'Git': '/referencias img/tecnologías/git.svg',
  'GitHub': '/referencias img/tecnologías/github.png',
  'Jira': '/referencias img/tecnologías/jira.png',
  'Firebase': '/referencias img/tecnologías/google-cloud.png',
  'AWS': '/referencias img/tecnologías/aws.png',
  'Laragon': '/referencias img/tecnologías/laragon.png',
  'Postman': '/referencias img/tecnologías/postman.svg',
  'Visual Studio Code': '/referencias img/tecnologías/Visual_Studio_Code_1.35_icon.svg.png',
  'VS Code': '/referencias img/tecnologías/Visual_Studio_Code_1.35_icon.svg.png',
  'Android Studio': '/referencias img/tecnologías/Android_Studio_icon_(2023).svg.png',
  'Unity': '/referencias img/tecnologías/unity.png',
  

  'TensorFlow': '/referencias img/tecnologías/tenserflow.png',
  'TensorFlow Lite': '/referencias img/tecnologías/tenserflow.png',
  'YOLO': '/referencias img/tecnologías/yolo.png',
  'Tailwind': '/referencias img/tecnologías/tailwind.svg',
  'Vite': '/referencias img/tecnologías/vite.png',
  'MySQL': '/referencias img/tecnologías/mysql.svg',
  'SQLite': '/referencias img/tecnologías/Sqlite.png',
  'C#': '/referencias img/tecnologías/c#.png',
};


const getIcon = (skillName: string) => skillIcons[skillName] || null;
---

<section id="habilidades" class="relative py-20 overflow-hidden">
  <SectionBackground variant="dark" gradientPosition="top" />
  
  <div class="container mx-auto px-4 relative z-10 max-w-6xl">
    

    <SectionTitle title={labels.title} align="center" />


    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8 mb-20">
      {technicalSkills.map((category, index) => (
        <Card 
          class={`animate-on-scroll ${index === technicalSkills.length - 1 && technicalSkills.length % 2 !== 0 ? 'md:col-span-2 md:w-2/3 md:mx-auto' : ''}`}
          style={`transition-delay: ${index * 100}ms`}
          data-animate
        >
          <h3 class="text-xl font-bold text-slate-100 mb-6 flex items-center gap-3">
            <span class="w-2 h-8 rounded-full bg-gradient-to-b from-emerald-400 to-teal-500"></span>
            {category.category}
          </h3>
          
          <div class="flex flex-wrap gap-3">
            {category.skills.map(skill => {
              const icon = getIcon(skill);
              return <Badge label={skill} icon={icon || undefined} />;
            })}
          </div>
        </Card>
      ))}
    </div>

  </div>
</section>

<script>
  const observerCallback = (entries: IntersectionObserverEntry[]) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  };

  const observer = new IntersectionObserver(observerCallback, {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  });

  document.querySelectorAll('#habilidades [data-animate]').forEach(el => {
    observer.observe(el);
  });
</script>

<style>

  .animate-on-scroll {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }
  
  .animate-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
