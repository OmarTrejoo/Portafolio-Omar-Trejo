---
import type { Education, Certification, Language } from '../types';
import SectionBackground from "./ui/SectionBackground.astro";
import SectionTitle from "./ui/SectionTitle.astro";
import Badge from "./ui/Badge.astro";

interface Props {
  education: Education;
  certifications: Certification[];
  languages: Language[];
  lang: 'es' | 'en';
}

const { education, certifications, languages, lang } = Astro.props;

const labels = {
  title: lang === 'es' ? 'Educaci√≥n' : 'Education',
  languages: lang === 'es' ? 'Idiomas' : 'Languages',
  certifications: lang === 'es' ? 'Certificaciones' : 'Certifications'
};
---

<section id="educacion" class="relative py-20 overflow-hidden bg-slate-900">
  <SectionBackground variant="dark" gradientPosition="center" />
  
  <div class="container mx-auto px-4 relative z-10 max-w-5xl">
    

    <SectionTitle title={labels.title} align="center" />

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
      

      <div class="space-y-10">
        

        <div class="animate-on-scroll" data-animate style="transition-delay: 100ms">
          <div class="relative pl-8 border-l border-slate-800">

            <div class="absolute -left-1.5 top-0 w-3 h-3 rounded-full bg-emerald-500 shadow-lg shadow-emerald-500/50"></div>
            
            <div class="space-y-2">
              <span class="inline-block text-xs font-bold text-emerald-400 mb-1">
                {education.period}
              </span>
              <h3 class="text-xl font-bold text-white leading-tight">
                {education.degree}
              </h3>
              <p class="text-slate-400 font-medium">
                {education.institution}
              </p>
              <p class="text-sm text-slate-500 flex items-center gap-2 mt-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                {education.location}
              </p>
            </div>
          </div>
        </div>


        <div class="animate-on-scroll" data-animate style="transition-delay: 200ms">
          <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-4">
            {labels.languages}
          </h3>
          <div class="grid grid-cols-1 gap-3">
            {languages.map((langItem) => (
              <div class="flex items-center justify-between p-3 bg-slate-950/50 border border-slate-800/50 rounded-lg hover:border-slate-700 transition-colors">
                <div class="flex items-center gap-3">
                   <div class="w-2 h-2 rounded-full bg-teal-500"></div>
                   <span class="text-slate-200 font-medium">{langItem.language}</span>
                </div>
                <Badge label={langItem.level} class="!py-0.5 !px-2 text-xs" />
              </div>
            ))}
          </div>
        </div>

      </div>


      <div class="animate-on-scroll" data-animate style="transition-delay: 300ms">
        <h3 class="text-sm font-bold text-slate-500 uppercase tracking-wider mb-6">
          {labels.certifications}
        </h3>
        
        <div class="space-y-4">
          {certifications.map((cert) => (
            cert.url ? (
              <a 
                href={cert.url}
                target="_blank"
                rel="noopener noreferrer"
                class="group block bg-slate-950 border border-slate-800/50 rounded-xl p-4 hover:border-emerald-500/30 hover:bg-slate-900 transition-all duration-300 relative overflow-hidden"
              >

                <div class="absolute left-0 top-0 bottom-0 w-1 bg-emerald-500 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                
                <div class="flex items-center justify-between gap-4">
                  <div class="flex-1 min-w-0">
                    <h4 class="text-slate-200 font-semibold leading-snug group-hover:text-white transition-colors">
                      {cert.name}
                    </h4>
                    {cert.issuer && (
                      <p class="text-xs text-slate-500 mt-1">
                        {cert.issuer}
                      </p>
                    )}
                  </div>


                  <div class="text-slate-600 group-hover:text-emerald-400 group-hover:translate-x-1 transition-all duration-300">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                  </div>
                </div>
              </a>
            ) : (
              <div class="bg-slate-950 border border-slate-800/50 rounded-xl p-4 opacity-80">
                <div class="flex items-center justify-between gap-4">
                  <div class="flex-1 min-w-0">
                    <h4 class="text-slate-300 font-semibold leading-snug">
                      {cert.name}
                    </h4>
                    {cert.issuer && (
                      <p class="text-xs text-slate-500 mt-1">
                        {cert.issuer}
                      </p>
                    )}
                  </div>
                </div>
              </div>
            )
          ))}
        </div>
      </div>

    </div>
  </div>
</section>

<script>
  function initEducationAnimations() {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
          }
        });
      },
      {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      }
    );

    const animatedElements = document.querySelectorAll('#educacion [data-animate]');
    animatedElements.forEach((el) => observer.observe(el));
  }

  document.addEventListener('DOMContentLoaded', initEducationAnimations);
  document.addEventListener('astro:page-load', initEducationAnimations);
</script>

<style>
  .animate-on-scroll {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }
  
  .animate-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>
